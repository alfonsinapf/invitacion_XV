<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitación Alfonsina 15</title>
    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" />
    <style>
        /* Estilos mínimos para que cargue rápido */
        body { margin:0; font-family: Arial, sans-serif; background:#fff; color:#333; }
        .hidden { display:none; }
        .button { cursor:pointer; padding:8px 16px; background:#d35400; color:#fff; border:none; border-radius:4px; }
        .button:hover { background:#e67e22; }
    </style>
</head>
<body>

<!-- Portada -->
<section id="portada">
    <h1>Alfonsina 15</h1>
    <p>¡Estás invitado a celebrar este día especial!</p>
    <audio id="audio-bg" loop>
        <source src="assets/audio/fondo.mp3" type="audio/mpeg">
    </audio>
    <button class="button" id="btn-play-audio">Play / Pause</button>
</section>

<!-- Contador regresivo -->
<section id="contador">
    <h2>Faltan:</h2>
    <div id="countdown">00:00:00:00</div>
</section>

<!-- Ceremonia -->
<section id="ceremonia">
    <h2>Ceremonia</h2>
    <p>Lugar y fecha del evento...</p>
</section>

<!-- Galería -->
<section id="galeria">
    <h2>Galería</h2>
    <a data-fancybox="gallery" href="assets/images/galeria1.jpg"><img src="assets/images/thumb1.jpg" alt="Foto 1"></a>
    <a data-fancybox="gallery" href="assets/images/galeria2.jpg"><img src="assets/images/thumb2.jpg" alt="Foto 2"></a>
</section>

<!-- Confirmación -->
<section id="confirmacion">
    <h2>Confirma tu asistencia</h2>
    <iframe src="https://docs.google.com/forms/d/e/FORM_ID/viewform?embedded=true" width="100%" height="500" frameborder="0">Cargando…</iframe>
</section>

<!-- Dress code -->
<section id="dresscode">
    <h2>Dress Code</h2>
    <p>Colores y estilo sugerido...</p>
</section>

<!-- Música -->
<section id="musica">
    <h2>Playlist Colaborativa</h2>
    <input type="text" id="busqueda-cancion" placeholder="Buscar canción">
    <button class="button" id="btn-buscar">Buscar</button>
    <div id="resultados"></div>
    <h3>Playlist actual</h3>
    <ul id="playlist"></ul>
    <p id="mensaje"></p>
</section>

<!-- Instagram -->
<section id="instagram">
    <h2>Síguenos en Instagram</h2>
    <a href="https://www.instagram.com/alfonsina15" target="_blank">@alfonsina15</a>
</section>

<!-- CBU / Regalos -->
<section id="regalos">
    <h2>Regalos</h2>
    <p>CBU: 1234567890123456789012</p>
</section>

<!-- Subida de fotos/videos -->
<section id="uploads">
    <h2>Subí tus fotos y videos</h2>
    <p>Escaneá el QR para enviar tus recuerdos</p>
    <img src="assets/images/qr.png" alt="QR Subida">
</section>

<!-- Agradecimiento -->
<section id="agradecimiento">
    <h2>Gracias por acompañarnos</h2>
    <p>¡Esperamos verte en la celebración!</p>
</section>

<!-- Contacto -->
<section id="contacto">
    <h2>Contacto</h2>
    <p>Email: contacto@alfonsina15.com</p>
</section>

<!-- Footer -->
<footer>
    <p>© 2025 Alfonsina 15</p>
</footer>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script>
<script>
    // Audio
    const audio = document.getElementById('audio-bg');
    document.getElementById('btn-play-audio').addEventListener('click', () => {
        if(audio.paused) audio.play();
        else audio.pause();
    });

    // Contador regresivo
    const countdownEl = document.getElementById('countdown');
    const fechaEvento = new Date('2025-11-01T21:00:00'); // ajustar fecha
    function actualizarContador() {
        const now = new Date();
        const diff = fechaEvento - now;
        if(diff < 0) { countdownEl.textContent = '¡Evento iniciado!'; return; }
        const dias = Math.floor(diff / (1000*60*60*24));
        const horas = Math.floor((diff/(1000*60*60)) % 24);
        const mins = Math.floor((diff/(1000*60)) % 60);
        const segs = Math.floor((diff/1000) % 60);
        countdownEl.textContent = `${dias}:${horas}:${mins}:${segs}`;
    }
    setInterval(actualizarContador,1000);
    actualizarContador();

    // Playlist colaborativa
    const btnBuscar = document.getElementById('btn-buscar');
    const inputBusqueda = document.getElementById('busqueda-cancion');
    const resultados = document.getElementById('resultados');
    const playlist = document.getElementById('playlist');
    const mensaje = document.getElementById('mensaje');

    async function cargarPlaylist() {
        try {
            const res = await fetch('https://invitacion-xv-seven.vercel.app/');
            const data = await res.json();
            playlist.innerHTML = '';
            data.tracks.forEach(track => {
                const li = document.createElement('li');
                li.textContent = track.name + ' - ' + track.artists.join(', ');
                playlist.appendChild(li);
            });
        } catch(e) { console.error(e); }
    }

    btnBuscar.addEventListener('click', async () => {
        const query = inputBusqueda.value.trim();
        if(!query) return;
        resultados.innerHTML = 'Buscando...';
        try {
            const res = await fetch(`https://TU_DOMINIO_VERCEL/api/search?q=${encodeURIComponent(query)}`);
            const data = await res.json();
            resultados.innerHTML = '';
            data.tracks.forEach(track => {
                const div = document.createElement('div');
                div.textContent = track.name + ' - ' + track.artists.join(', ');
                const btn = document.createElement('button');
                btn.textContent = 'Agregar';
                btn.className = 'button';
                btn.addEventListener('click', async () => {
                    try {
                        const r = await fetch('https://TU_DOMINIO_VERCEL/api/add-to-playlist', {
                            method:'POST',
                            headers:{'Content-Type':'application/json'},
                            body: JSON.stringify({ uri: track.uri })
                        });
                        const resAdd = await r.json();
                        if(resAdd.success) { mensaje.textContent = 'Canción agregada'; cargarPlaylist(); }
                        else mensaje.textContent = 'Error al agregar';
                    } catch(e){ mensaje.textContent = 'Error al agregar'; }
                });
                div.appendChild(btn);
                resultados.appendChild(div);
            });
        } catch(e){ resultados.textContent = 'Error en la búsqueda'; console.error(e); }
    });

    cargarPlaylist();
</script>

</body>
</html>
