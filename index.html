<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invitación de XV - Alfonsina</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Montserrat', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 20px;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .music-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
        }
        
        .player-container {
            margin-bottom: 30px;
        }
        
        .spotify-embed {
            width: 100%;
            height: 380px;
            border-radius: 12px;
            border: none;
        }
        
        .config-error {
            background: rgba(255, 193, 7, 0.2);
            border: 1px solid #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .config-error i {
            font-size: 3rem;
            margin-bottom: 15px;
            display: block;
            color: #ffc107;
        }
        
        .alternative-options {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        
        .alt-option {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            flex: 1;
            min-width: 250px;
            transition: transform 0.3s;
        }
        
        .alt-option:hover {
            transform: translateY(-5px);
        }
        
        .alt-option i {
            font-size: 2.5rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .alt-button {
            background: #1DB954;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            cursor: pointer;
            margin-top: 15px;
            transition: background 0.3s;
            font-weight: 600;
        }
        
        .alt-button:hover {
            background: #1ed760;
        }
        
        .contact-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            text-align: center;
        }
        
        .contact-info a {
            color: #1DB954;
            text-decoration: none;
            font-weight: 600;
        }
        
        .contact-info a:hover {
            text-decoration: underline;
        }
        
        .search-section {
            margin-top: 30px;
        }
        
        .search-box {
            display: flex;
            margin-bottom: 20px;
        }
        
        .search-input {
            flex: 1;
            padding: 15px 20px;
            border: none;
            border-radius: 50px 0 0 50px;
            font-size: 1rem;
            outline: none;
        }
        
        .search-button {
            padding: 15px 25px;
            background: #1DB954;
            color: white;
            border: none;
            border-radius: 0 50px 50px 0;
            cursor: pointer;
            font-weight: bold;
        }
        
        .results-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .song-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            transition: transform 0.3s;
        }
        
        .song-card:hover {
            transform: translateY(-5px);
        }
        
        .song-info {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .song-icon {
            width: 50px;
            height: 50px;
            background: #333;
            border-radius: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
            font-size: 1.5rem;
        }
        
        .song-details {
            flex: 1;
        }
        
        .song-name {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .song-artist {
            opacity: 0.8;
            font-size: 0.9rem;
        }
        
        .admin-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }
        
        .admin-info h3 {
            margin-bottom: 15px;
            color: #ffc107;
        }
        
        .admin-steps {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        .admin-steps li {
            margin-bottom: 10px;
        }
        
        @media (max-width: 768px) {
            .alternative-options {
                flex-direction: column;
            }
            
            .alt-option {
                min-width: 100%;
            }
            
            .results-container {
                grid-template-columns: 1fr;
            }
            
            .search-box {
                flex-direction: column;
            }
            
            .search-input {
                border-radius: 50px;
                margin-bottom: 10px;
            }
            
            .search-button {
                border-radius: 50px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Música para XV Años</h1>
            <p class="subtitle">Disfruta de la playlist y sugiere canciones para la fiesta</p>
        </header>
        
        <div class="music-section">
            <div class="player-container">
                <iframe class="spotify-embed" src="https://open.spotify.com/embed/playlist/0a4iq5x0WHzzn0ox7ea77u?utm_source=generator&theme=0" 
                    frameborder="0" allowfullscreen="" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
                    loading="lazy">
                </iframe>
            </div>
            
            <div class="config-error">
                <i class="fas fa-cogs"></i>
                <h2>Configuración de Spotify incompleta</h2>
                <p>El sistema de sugerencia de canciones no está disponible temporalmente debido a un problema de configuración.</p>
                <p>Estamos trabajando para resolver el problema. Mientras tanto, puedes disfrutar de la playlist y utilizar las alternativas que te ofrecemos a continuación.</p>
            </div>
            
            <div class="alternative-options">
                <div class="alt-option">
                    <i class="fas fa-music"></i>
                    <h3>Búsqueda alternativa</h3>
                    <p>Busca canciones utilizando nuestro sistema alternativo (sin necesidad de Spotify)</p>
                    <button class="alt-button" id="altSearchButton">Buscar canciones</button>
                </div>
                
                <div class="alt-option">
                    <i class="fas fa-envelope"></i>
                    <h3>Sugerir por formulario</h3>
                    <p>Envíanos tus sugerencias musicales a través de nuestro formulario de Google</p>
                    <button class="alt-button" id="formButton">Abrir formulario</button>
                </div>
                
                <div class="alt-option">
                    <i class="fas fa-comments"></i>
                    <h3>Contactar directamente</h3>
                    <p>Envía un mensaje directo con tus sugerencias musicales</p>
                    <button class="alt-button" id="contactButton">Ver información de contacto</button>
                </div>
            </div>
            
            <div class="contact-info" id="contactInfo" style="display: none;">
                <h3>Contacta con nosotros</h3>
                <p>Puedes enviar tus sugerencias musicales directamente a:</p>
                <p><i class="fas fa-envelope"></i> <a href="mailto:alfonsinapf@icloud.com">alfonsinapf@icloud.com</a></p>
                <p><i class="fab fa-whatsapp"></i> <a href="https://api.whatsapp.com/send?phone=542477684660">+54 2477 68-4660</a></p>
            </div>

            <!-- Sección de búsqueda alternativa (inicialmente oculta) -->
            <div class="search-section" id="altSearchSection" style="display: none;">
                <div class="search-box">
                    <input type="text" class="search-input" id="altSongSearch" placeholder="Escribe el nombre de una canción o artista...">
                    <button class="search-button" id="altSearchBtn"><i class="fas fa-search"></i> Buscar</button>
                </div>
                
                <div class="results-container" id="altSearchResults">
                    <!-- Los resultados se mostrarán aquí -->
                </div>
            </div>

            <!-- Información para el administrador -->
            <div class="admin-info">
                <h3>Información para el administrador:</h3>
                <p>Para resolver el error "Configuración de Spotify incompleta", necesitas configurar correctamente las variables de entorno en Vercel:</p>
                <ol class="admin-steps">
                    <li>Ve al dashboard de tu proyecto en <a href="https://vercel.com" style="color: #1DB954;">Vercel</a></li>
                    <li>Accede a la sección de Settings → Environment Variables</li>
                    <li>Asegúrate de tener configuradas estas variables:
                        <ul>
                            <li>SPOTIFY_CLIENT_ID</li>
                            <li>SPOTIFY_CLIENT_SECRET</li>
                            <li>SPOTIFY_REFRESH_TOKEN</li>
                            <li>SPOTIFY_PLAYLIST_ID</li>
                        </ul>
                    </li>
                    <li>Si necesitas generar un nuevo refresh token, puedes usar herramientas como <a href="https://github.com/spotify/spotify-web-api-node" style="color: #1DB954;">Spotify Web API Node</a></li>
                </ol>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const altSearchButton = document.getElementById('altSearchButton');
            const formButton = document.getElementById('formButton');
            const contactButton = document.getElementById('contactButton');
            const contactInfo = document.getElementById('contactInfo');
            const altSearchSection = document.getElementById('altSearchSection');
            const altSearchBtn = document.getElementById('altSearchBtn');
            const altSongSearch = document.getElementById('altSongSearch');
            const altSearchResults = document.getElementById('altSearchResults');
            
            // Abrir formulario de sugerencias
            formButton.addEventListener('click', function() {
                window.open("https://docs.google.com/forms/d/e/1FAIpQLSflLqhwmhvp2uNeFbliUVQFj3Yhgkko3xh0nRF-6A47T-aCKg/viewform", "_blank");
            });
            
            // Mostrar información de contacto
            contactButton.addEventListener('click', function() {
                if (contactInfo.style.display === 'none') {
                    contactInfo.style.display = 'block';
                } else {
                    contactInfo.style.display = 'none';
                }
            });
            
            // Mostrar sección de búsqueda alternativa
            altSearchButton.addEventListener('click', function() {
                if (altSearchSection.style.display === 'none') {
                    altSearchSection.style.display = 'block';
                    // Desplazarse suavemente a la sección de búsqueda
                    altSearchSection.scrollIntoView({ behavior: 'smooth' });
                } else {
                    altSearchSection.style.display = 'none';
                }
            });
            
            // Búsqueda alternativa con Last.fm API
            altSearchBtn.addEventListener('click', function() {
                const query = altSongSearch.value.trim();
                if (!query) {
                    alert('Por favor, ingresa un término de búsqueda');
                    return;
                }
                
                altSearchResults.innerHTML = '<div style="text-align: center; padding: 30px;"><i class="fas fa-spinner fa-spin" style="font-size: 2rem;"></i><p>Buscando canciones...</p></div>';
                
                // Usar Last.fm API como alternativa
                fetch(`https://ws.audioscrobbler.com/2.0/?method=track.search&track=${encodeURIComponent(query)}&api_key=5a8e1586e85b499c62d9f3a4bfa5b6a9&format=json&limit=8`)
                    .then(response => response.json())
                    .then(data => {
                        const tracks = data.results?.trackmatches?.track || [];
                        
                        if (tracks.length === 0) {
                            altSearchResults.innerHTML = '<p style="text-align: center; padding: 30px;">No se encontraron resultados. Intenta con otros términos.</p>';
                            return;
                        }
                        
                        let resultsHTML = '';
                        
                        tracks.forEach(track => {
                            resultsHTML += `
                                <div class="song-card">
                                    <div class="song-info">
                                        <div class="song-icon">
                                            <i class="fas fa-music"></i>
                                        </div>
                                        <div class="song-details">
                                            <div class="song-name">${track.name}</div>
                                            <div class="song-artist">${track.artist}</div>
                                        </div>
                                    </div>
                                    <button class="alt-button" style="width: 100%;" onclick="suggestSong('${track.name.replace(/'/g, "\\'")}', '${track.artist.replace(/'/g, "\\'")}')">
                                        <i class="fas fa-plus"></i> Sugerir esta canción
                                    </button>
                                </div>
                            `;
                        });
                        
                        altSearchResults.innerHTML = resultsHTML;
                    })
                    .catch(error => {
                        console.error('Error en búsqueda alternativa:', error);
                        altSearchResults.innerHTML = '<p style="text-align: center; padding: 30px;">Error en la búsqueda. Intenta nuevamente.</p>';
                    });
            });
            
            // Buscar al presionar Enter
            altSongSearch.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    altSearchBtn.click();
                }
            });
        });
        
        // Función para sugerir canción
        function suggestSong(trackName, artistName) {
            // Crear un mensaje con la sugerencia
            const message = `Sugerencia de canción para la playlist:\n\nCanción: ${trackName}\nArtista: ${artistName}`;
            
            // Abrir el cliente de correo con el mensaje predefinido
            window.open(`mailto:alfonsinapf@icloud.com?subject=Sugerencia de canción para XV Años&body=${encodeURIComponent(message)}`, '_blank');
            
            // Mostrar confirmación al usuario
            alert(`¡Gracias por tu sugerencia!\n\nHas sugerido: ${trackName} - ${artistName}\n\nSe abrirá tu cliente de correo para que puedas enviar la sugerencia.`);
        }
    </script>
</body>
</html>
